===== FILE: ./features/server_picker/data/mock_servers.dart =====
class ServerItem {
  final String id;
  final String name;
  final String country;
  final int latencyMs;
  final bool isMine;
  final bool isFavorite;
  final String countryCode;

  const ServerItem({
    required this.id,
    required this.name,
    required this.country,
    required this.latencyMs,
    required this.isMine,
    required this.isFavorite,
    required this.countryCode,
  });

  ServerItem copyWith({bool? isFavorite}) => ServerItem(
    id: id,
    name: name,
    country: country,
    latencyMs: latencyMs,
    isMine: isMine,
    isFavorite: isFavorite ?? this.isFavorite,
    countryCode: '',
  );
}

const mockServers = <ServerItem>[
  ServerItem(
    id: 'de-berlin-1',
    name: 'Берлин',
    country: 'Германия',
    latencyMs: 120,
    isMine: true,
    isFavorite: false,
    countryCode: 'DE',
  ),
  ServerItem(
    id: 'de-berlin-2',
    name: 'Берлин',
    country: 'Германия',
    latencyMs: 120,
    isMine: false,
    isFavorite: false,
    countryCode: 'DE',
  ),
  ServerItem(
    id: 'de-berlin-3',
    name: 'Берлин',
    country: 'Германия',
    latencyMs: 120,
    isMine: false,
    isFavorite: true,
    countryCode: 'DE',
  ),
  ServerItem(
    id: 'us-ny-1',
    name: 'Нью-Йорк',
    country: 'США',
    latencyMs: 180,
    isMine: false,
    isFavorite: false,
    countryCode: 'US',
  ),
];



===== FILE: ./features/server_picker/presentation/pages/server_picker_page.dart =====
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:vpn_server_picker/core/theme/app_colors.dart';
import 'package:vpn_server_picker/core/theme/app_dimens.dart';
import 'package:vpn_server_picker/features/server_picker/data/mock_servers.dart';
import 'package:vpn_server_picker/features/server_picker/presentation/bloc/server_picker_bloc.dart';
import 'package:vpn_server_picker/features/server_picker/presentation/bloc/server_picker_event.dart';
import 'package:vpn_server_picker/features/server_picker/presentation/bloc/server_picker_state.dart';
import 'package:vpn_server_picker/features/server_picker/presentation/widgets/empty_state.dart';
import 'package:vpn_server_picker/features/server_picker/presentation/widgets/section_title.dart';
import 'package:vpn_server_picker/features/server_picker/presentation/widgets/server_tile.dart';

class ServerPickerPage extends StatelessWidget {
  const ServerPickerPage({super.key});

  @override
  Widget build(BuildContext context) {
    return BlocProvider(
      create: (_) => ServerPickerBloc(),
      child: const _View(),
    );
  }
}

class _View extends StatelessWidget {
  const _View();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: SafeArea(
        child: Padding(
          padding: const EdgeInsets.all(AppDimens.p16),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              _TopBar(),
              const SizedBox(height: AppDimens.h16),
              _Tabs(),
              const SizedBox(height: AppDimens.h12),
              _SearchField(),
              const SizedBox(height: 12),
              const _MyAccessPointsLabel(),
              const SizedBox(height: 10),
              _AddKeyButton(),
              const SizedBox(height: AppDimens.h16),

              Expanded(
                child: BlocBuilder<ServerPickerBloc, ServerPickerState>(
                  buildWhen: (p, n) =>
                      p.tab != n.tab ||
                      p.query != n.query ||
                      p.servers != n.servers ||
                      p.selectedServerId != n.selectedServerId,
                  builder: (context, state) {
                    final items = state.filtered;

                    if (items.isEmpty) {
                      return const EmptyState(
                        centered: false,
                        topPadding: 48,
                        title: 'Нет результатов',
                        subtitle:
                            'По вашему запросу серверов\nне найдено. Попробуйте изменить\nзапрос или проверьте написание.',
                      );
                    }

                    final order = <String>[];
                    final map = <String, List<ServerItem>>{};
                    for (final s in items) {
                      map
                          .putIfAbsent(s.country, () {
                            order.add(s.country);
                            return <ServerItem>[];
                          })
                          .add(s);
                    }

                    return ListView(
                      padding: EdgeInsets.zero,
                      children: [
                        for (final country in order) ...[
                          SectionTitle(country),
                          ...map[country]!.map(
                            (s) => Padding(
                              padding: const EdgeInsets.only(bottom: 10),
                              child: ServerTile(
                                item: s,
                                selected: s.id == state.selectedServerId,
                                onTap: () => context
                                    .read<ServerPickerBloc>()
                                    .add(ServerSelected(s.id)),
                                onFavorite: () => context
                                    .read<ServerPickerBloc>()
                                    .add(ServerFavoriteToggled(s.id)),
                                trailingText:
                                    (state.tab == ServerTab.mine && s.isMine)
                                    ? 'Удалить'
                                    : null,
                              ),
                            ),
                          ),
                        ],
                        const SizedBox(height: 8),
                      ],
                    );
                  },
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}

class _TopBar extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        SizedBox(
          width: 36,
          height: 36,
          child: IconButton(
            padding: EdgeInsets.zero,
            onPressed: () {},
            icon: const Icon(Icons.arrow_back_ios_new_rounded, size: 18),
          ),
        ),
        const SizedBox(height: 8),
        Text('Точки доступа', style: Theme.of(context).textTheme.headlineSmall),
      ],
    );
  }
}

class _Tabs extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return BlocBuilder<ServerPickerBloc, ServerPickerState>(
      buildWhen: (p, n) => p.tab != n.tab,
      builder: (context, state) {
        return Container(
          height: 44,
          padding: const EdgeInsets.all(4),
          decoration: BoxDecoration(
            color: AppColors.surface2,
            borderRadius: BorderRadius.circular(AppDimens.r20),
          ),
          child: Row(
            children: [
              _TabButton(
                label: 'Все',
                selected: state.tab == ServerTab.all,
                onTap: () => context.read<ServerPickerBloc>().add(
                  const ServerTabChanged(ServerTab.all),
                ),
              ),
              _TabButton(
                label: 'Мои',
                selected: state.tab == ServerTab.mine,
                onTap: () => context.read<ServerPickerBloc>().add(
                  const ServerTabChanged(ServerTab.mine),
                ),
              ),
              _TabButton(
                label: 'Избранные',
                selected: state.tab == ServerTab.favorites,
                onTap: () => context.read<ServerPickerBloc>().add(
                  const ServerTabChanged(ServerTab.favorites),
                ),
              ),
            ],
          ),
        );
      },
    );
  }
}

class _TabButton extends StatelessWidget {
  final String label;
  final bool selected;
  final VoidCallback onTap;

  const _TabButton({
    required this.label,
    required this.selected,
    required this.onTap,
  });

  @override
  Widget build(BuildContext context) {
    return Expanded(
      child: GestureDetector(
        behavior: HitTestBehavior.opaque,
        onTap: onTap,
        child: AnimatedContainer(
          duration: const Duration(milliseconds: 180),
          alignment: Alignment.center,
          decoration: BoxDecoration(
            color: selected ? AppColors.primary : Colors.transparent,
            borderRadius: BorderRadius.circular(AppDimens.r20),
          ),
          child: Text(
            label,
            style: Theme.of(context).textTheme.titleMedium?.copyWith(
              fontSize: 13,
              fontWeight: FontWeight.w600,
              color: selected ? Colors.white : AppColors.textSecondary,
            ),
          ),
        ),
      ),
    );
  }
}

class _SearchField extends StatefulWidget {
  @override
  State<_SearchField> createState() => _SearchFieldState();
}

class _SearchFieldState extends State<_SearchField> {
  late final TextEditingController _c;

  @override
  void initState() {
    super.initState();
    _c = TextEditingController();
  }

  @override
  void dispose() {
    _c.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return BlocListener<ServerPickerBloc, ServerPickerState>(
      listenWhen: (p, n) => p.query != n.query,
      listener: (_, state) {
        if (state.query.isEmpty && _c.text.isNotEmpty) _c.clear();
      },
      child: Container(
        height: 56,
        padding: const EdgeInsets.symmetric(horizontal: 12),
        decoration: BoxDecoration(
          color: AppColors.surface2,
          borderRadius: BorderRadius.circular(AppDimens.r16),
          border: Border.all(color: AppColors.stroke.withOpacity(0.25)),
        ),
        child: Row(
          children: [
            const Icon(
              Icons.search_rounded,
              size: 20,
              color: AppColors.textSecondary,
            ),
            const SizedBox(width: 8),
            Expanded(
              child: TextField(
                controller: _c,
                onChanged: (v) => context.read<ServerPickerBloc>().add(
                  ServerSearchChanged(v),
                ),
                textAlignVertical: TextAlignVertical.center,
                decoration: InputDecoration(
                  hintText: 'Поиск',
                  hintStyle: Theme.of(context).textTheme.bodyMedium?.copyWith(
                    color: AppColors.textSecondary,
                  ),
                  border: InputBorder.none,
                  isDense: true,
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }
}

class _MyAccessPointsLabel extends StatelessWidget {
  const _MyAccessPointsLabel();

  @override
  Widget build(BuildContext context) {
    return Text(
      'Мои точки доступа',
      style: Theme.of(context).textTheme.bodyMedium?.copyWith(
        color: AppColors.textSecondary,
        fontSize: 12,
        fontWeight: FontWeight.w600,
      ),
    );
  }
}

class _AddKeyButton extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return SizedBox(
      height: 56,
      width: double.infinity,
      child: ElevatedButton(
        onPressed: () {},
        style: ElevatedButton.styleFrom(
          backgroundColor: AppColors.primary,
          foregroundColor: Colors.white,
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(AppDimens.r16),
          ),
        ),
        child: const Text(
          'Добавить ключ',
          style: TextStyle(fontSize: 16, fontWeight: FontWeight.w700),
        ),
      ),
    );
  }
}



===== FILE: ./features/server_picker/presentation/widgets/section_title.dart =====
import 'package:flutter/material.dart';
import 'package:vpn_server_picker/core/theme/app_colors.dart';

class SectionTitle extends StatelessWidget {
  final String text;
  const SectionTitle(this.text, {super.key});

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: const EdgeInsets.fromLTRB(4, 12, 4, 8),
      child: Text(
        text,
        style: Theme.of(context).textTheme.bodyMedium?.copyWith(
          color: AppColors.textSecondary,
          fontSize: 12,
          fontWeight: FontWeight.w600,
        ),
      ),
    );
  }
}



===== FILE: ./features/server_picker/presentation/widgets/empty_state.dart =====
import 'package:flutter/material.dart';
import 'package:vpn_server_picker/core/theme/app_colors.dart';

class EmptyState extends StatelessWidget {
  final String title;
  final String subtitle;
  final bool centered;
  final double topPadding;

  const EmptyState({
    super.key,
    required this.title,
    required this.subtitle,
    this.centered = true,
    this.topPadding = 0,
  });

  @override
  Widget build(BuildContext context) {
    final content = Padding(
      padding: EdgeInsets.only(left: 24, right: 24, top: topPadding),
      child: Column(
        mainAxisSize: MainAxisSize.min,
        mainAxisAlignment: centered
            ? MainAxisAlignment.center
            : MainAxisAlignment.start,
        children: [
          Text(
            title,
            style: Theme.of(context).textTheme.titleMedium?.copyWith(
              fontSize: 18,
              fontWeight: FontWeight.w700,
            ),
            textAlign: TextAlign.center,
          ),
          const SizedBox(height: 8),
          Text(
            subtitle,
            style: Theme.of(context).textTheme.bodyMedium?.copyWith(
              color: AppColors.textSecondary,
              height: 1.3,
            ),
            textAlign: TextAlign.center,
          ),
        ],
      ),
    );

    if (centered) return Center(child: content);
    return Align(alignment: Alignment.topCenter, child: content);
  }
}



===== FILE: ./features/server_picker/presentation/widgets/server_tile.dart =====
import 'package:flutter/material.dart';
import 'package:vpn_server_picker/core/theme/app_colors.dart';
import 'package:vpn_server_picker/core/theme/app_dimens.dart';
import 'package:vpn_server_picker/features/server_picker/data/mock_servers.dart';
import 'package:country_flags/country_flags.dart';

class ServerTile extends StatelessWidget {
  final ServerItem item;
  final bool selected;
  final VoidCallback onTap;
  final VoidCallback onFavorite;
  final String? trailingText;

  const ServerTile({
    super.key,
    required this.item,
    required this.selected,
    required this.onTap,
    required this.onFavorite,
    this.trailingText,
  });

  @override
  Widget build(BuildContext context) {
    return GestureDetector(
      onTap: onTap,
      behavior: HitTestBehavior.opaque,
      child: AnimatedContainer(
        duration: const Duration(milliseconds: 160),
        padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 10),
        decoration: BoxDecoration(
          color: Colors.transparent,
          borderRadius: BorderRadius.circular(AppDimens.r16),
          border: Border.all(
            color: selected
                ? AppColors.primary.withOpacity(0.9)
                : AppColors.stroke.withOpacity(0.35),
            width: selected ? 1.5 : 1,
          ),
          boxShadow: selected
              ? [
                  BoxShadow(
                    color: AppColors.primary.withOpacity(0.18),
                    blurRadius: 12,
                    offset: const Offset(0, 4),
                  ),
                ]
              : const [],
        ),
        child: Row(
          children: [
            _FlagCircle(country: item.country),
            const SizedBox(width: 12),
            Expanded(
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    item.name,
                    style: Theme.of(context).textTheme.titleMedium?.copyWith(
                      fontSize: 15,
                      fontWeight: FontWeight.w700,
                    ),
                  ),
                  const SizedBox(height: 2),
                  Text(
                    '${item.latencyMs} мс',
                    style: Theme.of(context).textTheme.bodyMedium?.copyWith(
                      color: AppColors.textSecondary,
                      fontSize: 12,
                    ),
                  ),
                ],
              ),
            ),
            const SizedBox(width: 12),
            if (trailingText != null) ...[
              Text(
                trailingText!,
                style: Theme.of(context).textTheme.bodyMedium?.copyWith(
                  color: const Color(0xFFFD4D4D),
                  fontSize: 12,
                  fontWeight: FontWeight.w600,
                ),
              ),
              const SizedBox(width: 10),
            ],
            GestureDetector(
              onTap: onFavorite,
              behavior: HitTestBehavior.opaque,
              child: Icon(
                item.isFavorite
                    ? Icons.favorite_rounded
                    : Icons.favorite_border_rounded,
                size: 20,
                color: item.isFavorite
                    ? AppColors.heartActive
                    : AppColors.heartInactive,
              ),
            ),
          ],
        ),
      ),
    );
  }
}

class _FlagCircle extends StatelessWidget {
  final String country;
  const _FlagCircle({required this.country});

  @override
  Widget build(BuildContext context) {
    return ClipOval(
      child: SizedBox(
        width: 36,
        height: 36,
        child: CountryFlag.fromCountryCode(country.toUpperCase()),
      ),
    );
  }
}



===== FILE: ./features/server_picker/presentation/bloc/server_picker_state.dart =====
import 'package:equatable/equatable.dart';
import 'package:vpn_server_picker/features/server_picker/data/mock_servers.dart';
import 'server_picker_event.dart';

class ServerPickerState extends Equatable {
  final ServerTab tab;
  final String query;
  final List<ServerItem> servers;
  final String selectedServerId;

  const ServerPickerState({
    required this.tab,
    required this.query,
    required this.servers,
    required this.selectedServerId,
  });

  factory ServerPickerState.initial() => const ServerPickerState(
    tab: ServerTab.all,
    query: '',
    servers: mockServers,
    selectedServerId: 'de-berlin-1',
  );

  ServerPickerState copyWith({
    ServerTab? tab,
    String? query,
    List<ServerItem>? servers,
    String? selectedServerId,
  }) {
    return ServerPickerState(
      tab: tab ?? this.tab,
      query: query ?? this.query,
      servers: servers ?? this.servers,
      selectedServerId: selectedServerId ?? this.selectedServerId,
    );
  }

  List<ServerItem> get filtered {
    final q = query.trim().toLowerCase();

    Iterable<ServerItem> items = servers;

    switch (tab) {
      case ServerTab.all:
        break;
      case ServerTab.mine:
        items = items.where((s) => s.isMine);
        break;
      case ServerTab.favorites:
        items = items.where((s) => s.isFavorite);
        break;
    }

    if (q.isNotEmpty) {
      items = items.where((s) => s.name.toLowerCase().contains(q));
    }

    return items.toList(growable: false);
  }

  @override
  List<Object?> get props => [tab, query, servers, selectedServerId];
}



===== FILE: ./features/server_picker/presentation/bloc/server_picker_event.dart =====
import 'package:equatable/equatable.dart';

enum ServerTab { all, mine, favorites }

sealed class ServerPickerEvent extends Equatable {
  const ServerPickerEvent();
  @override
  List<Object?> get props => [];
}

class ServerTabChanged extends ServerPickerEvent {
  final ServerTab tab;
  const ServerTabChanged(this.tab);
  @override
  List<Object?> get props => [tab];
}

class ServerSearchChanged extends ServerPickerEvent {
  final String query;
  const ServerSearchChanged(this.query);
  @override
  List<Object?> get props => [query];
}

class ServerFavoriteToggled extends ServerPickerEvent {
  final String serverId;
  const ServerFavoriteToggled(this.serverId);
  @override
  List<Object?> get props => [serverId];
}

class ServerSelected extends ServerPickerEvent {
  final String serverId;
  const ServerSelected(this.serverId);

  @override
  List<Object?> get props => [serverId];
}



===== FILE: ./features/server_picker/presentation/bloc/server_picker_bloc.dart =====
import 'package:flutter_bloc/flutter_bloc.dart';
import 'server_picker_event.dart';
import 'server_picker_state.dart';

class ServerPickerBloc extends Bloc<ServerPickerEvent, ServerPickerState> {
  ServerPickerBloc() : super(ServerPickerState.initial()) {
    on<ServerTabChanged>((e, emit) {
      emit(state.copyWith(tab: e.tab, query: ''));
    });
    on<ServerSearchChanged>((e, emit) => emit(state.copyWith(query: e.query)));
    on<ServerFavoriteToggled>(_onFavoriteToggled);
    on<ServerSelected>(
      (e, emit) => emit(state.copyWith(selectedServerId: e.serverId)),
    );
  }

  void _onFavoriteToggled(
    ServerFavoriteToggled event,
    Emitter<ServerPickerState> emit,
  ) {
    final updated = state.servers
        .map((s) {
          if (s.id != event.serverId) return s;
          return s.copyWith(isFavorite: !s.isFavorite);
        })
        .toList(growable: false);

    emit(state.copyWith(servers: updated));
  }
}



===== FILE: ./core/theme/app_dimens.dart =====
class AppDimens {
  static const r16 = 16.0;
  static const r20 = 20.0;

  static const p16 = 16.0;
  static const p12 = 12.0;

  static const h12 = 12.0;
  static const h16 = 16.0;
}



===== FILE: ./core/theme/app_colors.dart =====
import 'package:flutter/material.dart';

class AppColors {
  static const bg = Color(0xFF1A2838);
  static const surface = Color(0xFF16283A);
  static const surface2 = Color(0xFF1B3046);
  static const stroke = Color(0xFF2B4561);

  static const primary = Color(0xFF1F66FF);

  static const textPrimary = Color(0xFFF2F5F8);
  static const textSecondary = Color(0xFF8FA3B8);

  static const heartInactive = Color(0xFF2D4865);
  static const heartActive = Color(0xFFC952F5);
}



===== FILE: ./main.dart =====
import 'package:flutter/material.dart';
import 'package:vpn_server_picker/core/theme/app_colors.dart';
import 'features/server_picker/presentation/pages/server_picker_page.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'VPN Server Picker',
      debugShowCheckedModeBanner: false,
      theme: AppTheme.dark(),
      home: const ServerPickerPage(),
    );
  }
}

class AppTheme {
  static ThemeData dark() {
    return ThemeData(
      useMaterial3: true,
      brightness: Brightness.dark,
      scaffoldBackgroundColor: AppColors.bg,
      colorScheme: const ColorScheme.dark(
        primary: AppColors.primary,
        surface: AppColors.surface,
        onSurface: AppColors.textPrimary,
        onPrimary: Colors.white,
      ),
      textTheme: const TextTheme(
        headlineSmall: TextStyle(
          fontSize: 28,
          fontWeight: FontWeight.w700,
          color: AppColors.textPrimary,
        ),
        titleMedium: TextStyle(
          fontSize: 16,
          fontWeight: FontWeight.w600,
          color: AppColors.textPrimary,
        ),
        bodyMedium: TextStyle(fontSize: 14, color: AppColors.textPrimary),
      ),
    );
  }
}



===== FILE: ./project.txt =====



===== FILE: ./1.sh =====
#!/bin/bash

OUTPUT="project.txt"

# очищаем файл вывода
> "$OUTPUT"

# ищем все обычные файлы рекурсивно
find . -type f | while read -r file; do
    # проверяем, что файл текстовый
    if file "$file" | grep -q text; then
        echo "===== FILE: $file =====" >> "$OUTPUT"
        cat "$file" >> "$OUTPUT"
        echo -e "\n\n" >> "$OUTPUT"
    fi
done



